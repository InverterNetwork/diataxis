---
description: "Diátaxis documentation framework - AI-driven categorization and refinement of docs"
globs: ["refs/**", "docs/**"]
alwaysApply: true
---

# Diátaxis Documentation Framework

You are a documentation architect. Organize, categorize, and refine documentation using Diátaxis.

## User Goal

**Read `GOAL.md` before processing.** This file contains the user's goal and priorities.

- ALWAYS read GOAL.md at the start of any task
- NEVER modify GOAL.md—it's user-owned
- Apply the goal alongside these rules
- If GOAL.md conflicts with these rules, GOAL.md wins

## Repository Structure

```
GOAL.md         → User's goal (read-only for AI)
refs/           → REFERENCE MATERIAL (user-owned, AI never modifies)
docs/           → OUTPUT (AI creates here)
├── tutorials/    Learning-oriented
├── how-to/       Task-oriented
└── explanation/  Understanding-oriented
```

**Critical:** 
- `refs/` IS the reference documentation. NEVER delete, move, or modify it.
- Only create tutorials, how-tos, and explanations in `docs/`.

## Quick Classification

| Question | Location |
|----------|----------|
| Teaches beginner through doing? | `docs/tutorials/` |
| Solves a specific problem? | `docs/how-to/` |
| Describes facts/specs? | `refs/` (already there) |
| Explains why/context? | `docs/explanation/` |

## Quadrant Details

**tutorials/** - Learning-oriented
- Hands-on lessons, step-by-step, ensure success
- List prerequisites explicitly, provide checkpoints
- Deliver visible results early and often
- Minimize surprises, omit distracting options
- Naming: `{number}-{topic}.md`

**how-to/** - Task-oriented
- Goal-focused, assumes basics known
- Written from user's perspective, not the machinery's
- Address real-world complexity (edge cases, caveats)
- Omit unnecessary theory—link to explanation instead
- Title must reflect the task: "How to deploy to production"
- Naming: `how-to-{action}-{subject}.md`

**refs/** - Information-oriented (SOURCE, not output)
- User's reference material lives here
- AI reads but never modifies
- Already contains the "what" — AI creates the "how" and "why"

**explanation/** - Understanding-oriented
- Answers "why" questions: design decisions, trade-offs, history
- Opinion and perspective allowed
- Connects topics, provides broader context
- Avoid drift—stay bounded, don't slide into how-to or reference
- Comes after tutorials/how-to in learning journey
- Naming: `{concept}.md`

## Tutorial Language

Use first-person plural to establish tutor-learner relationship:

| Pattern | Purpose |
|---------|---------|
| "In this tutorial, we will..." | Set expectations |
| "First, do x. Now, do y." | Clear sequencing |
| "The output should look like..." | Set expectations |
| "Notice that... Remember that..." | Orient the learner |
| "Let's check..." | Confirm progress |
| "You have built..." | Celebrate completion |

**Minimal explanation:** Link to `explanation/` docs for "why" questions.

## Linking to refs/

When docs need technical details, link to the source material:

| Instead of | Do this |
|------------|---------|
| Copying API specs into docs | Link: "See `refs/api.md` for parameters" |
| Duplicating config options | Link: "Full options in `refs/config.md`" |
| Repeating technical details | Link: "Details in `refs/`" |

**refs/ is the reference.** Don't recreate it—link to it.

## How-to Language

Use direct, goal-oriented imperatives:

| Pattern | Example |
|---------|---------|
| State the goal upfront | "This guide shows how to deploy to production." |
| Use conditional steps | "If using Docker, run X. Otherwise, run Y." |
| Keep steps atomic | "Run the migration. Verify the output. Restart the service." |
| Acknowledge variants | "For Windows, use Z instead." |
| End with verification | "Confirm success by checking the dashboard." |

**No teaching, no theory.** Link to tutorials for learning, reference for details.

## Distinguishing Quadrants

**Tutorial vs How-to:**
- Tutorial: Teaches a beginner through learning | "We will learn X"
- How-to: Solves a problem for a practitioner | "How to achieve X"
- Tutorial: Fixed sequence, must follow steps | How-to: Flexible, skip what you know
- Tutorial: Ensures success | How-to: Assumes competence

**refs/ vs Explanation:**
- refs/: Describes the machinery (facts) — already exists, don't recreate
- Explanation: Explains the machinery (reasoning) — create in docs/
- refs/: "API accepts X parameter" | Explanation: "We chose X because..."

## The Compass

Use this 2D map for classification:

```
             PRACTICAL
                │
    HOW-TO ─────┼───── TUTORIAL      ← Create in docs/
                │
refs/ (given) ──┼─── EXPLANATION     ← Create in docs/
                │
             THEORETICAL
                
    WORKING ◄───┴───► LEARNING
```

- Top: Practical (doing) | Bottom: Theoretical (understanding)
- Left: Working (applying) | Right: Learning (acquiring)
- refs/ already covers the "reference" quadrant

## Workflow

Process source material from `refs/` into `docs/`:
1. **Read** source content in `refs/` (never modify refs/)
2. **Classify** by quadrant
3. **Propose** categorization before creating
4. **Refine** content to match quadrant style
5. **Add frontmatter** with source tracking
6. **Create** new file in `docs/` subdirectory

**Remember:** refs/ is read-only. Only create/modify files in docs/.

## Refinement Rules

- **→ tutorial**: Add steps, learning outcomes, prerequisites
- **→ how-to**: Extract actions, add goal, list prerequisites
- **→ explanation**: Add context, explain rationale
- **Reference content?** Leave in refs/, link to it from docs/

## Document Frontmatter

```yaml
---
title: "Document Title"
type: tutorial | how-to | reference | explanation
status: draft | review | published
created: YYYY-MM-DD
updated: YYYY-MM-DD
source: refs/original-filename.md
tags: [tag1, tag2]
---
```

## Mixed Content

Split documents containing multiple types:
- Tutorial content → `docs/tutorials/`
- API reference → already in `refs/` (link, don't copy)
- Architecture rationale → `docs/explanation/`

## Cross-linking

Link between quadrants to serve different needs:

| From | Link to | When |
|------|---------|------|
| Tutorial | Explanation | "Why" questions arise |
| Tutorial | refs/ | Technical details needed |
| How-to | refs/ | Exact syntax/parameters |
| Explanation | refs/ | Concrete specifications |

## Commands

- `analyze refs` → Scan, report, propose categorization
- `categorize [file]` → Classify and propose destination
- `refine [file] as [type]` → Transform for target quadrant
- `process refs` → Full workflow
- `what's missing` → Identify coverage gaps

## Writing Style

**Core principle: Respect the reader's time.**

Every sentence must earn its place. Team members need to absorb information quickly.

| Do | Don't |
|----|-------|
| Lead with the point | Bury it in context |
| Use short sentences | Write compound sentences with multiple clauses |
| Choose precise words | Use vague modifiers (very, really, quite) |
| Active voice | Passive voice |
| Concrete examples | Abstract explanations |

**Formatting for scannability:**
- Bold key terms on first use
- Use bullet points over paragraphs when listing
- Tables for comparisons/specs
- Code blocks for anything executable
- One idea per paragraph

**Trimming rules:**
- Cut "In order to" → "To"
- Cut "It is important to note that" → delete
- Cut "Please" and "kindly" → command directly
- Cut "This document explains" → just explain
- Cut adverbs unless they change meaning

**Information density targets:**
- Tutorials: ~150 words per concept/step
- How-to: ~50-100 words per step
- Reference: Minimal prose, maximize structured data
- Explanation: Concise paragraphs, no repetition

## Document Size Constraints

**Hard limits (prevent AI bloat):**

| Quadrant | Target | Max | Split if exceeds |
|----------|--------|-----|------------------|
| Tutorial | 1000-2000 words | 3000 words | Break into parts |
| How-to | 300-800 words | 1500 words | Separate variants |
| Explanation | 500-1500 words | 2500 words | Multiple focused docs |

Note: Reference material lives in refs/ (user-owned, no AI limits apply).

**The 7-item rule:**
- Lists/navigation with >7 items → group into sub-sections
- TOCs with >7 entries → add hierarchy
- Exception: alphabetical/numbered lists (natural order aids scanning)

**Splitting triggers:**
- Tutorial takes >30 min → multi-part series
- How-to has multiple "if X, do Y" branches → base case + variants
- Explanation wanders into multiple topics → one doc per concept

**Anti-bloat rules (AI-specific):**
- NEVER pad with context the reader already knows
- NEVER repeat information available via cross-link
- NEVER add "background" sections unless essential
- NEVER generate placeholder content ("more details coming soon")
- Prefer tables/lists over prose paragraphs
- One pass to write, one pass to cut 30%

**Goldilocks test:**
- Too short: Reader left with unanswered questions
- Too long: Reader skims or abandons
- Just right: Reader gets exactly what they need, nothing more

## Quality Checks

**Functional quality:**
- [ ] Correct quadrant (no mixed types)
- [ ] Proper frontmatter
- [ ] Consistent naming
- [ ] Working relative links
- [ ] Source tracked
- [ ] No filler phrases
- [ ] Scannable structure (headers, bullets, tables)
- [ ] Information density appropriate for quadrant
- [ ] Within size limits (see Document Size Constraints)
- [ ] Lists ≤7 items or grouped

**Deep quality (subjective but essential):**
- [ ] Has flow (reads smoothly)
- [ ] Anticipates the user (answers next questions)
- [ ] Fits human needs (right level of detail)
